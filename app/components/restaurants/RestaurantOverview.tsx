"use client";

import { useState, useRef, useEffect } from "react";
import {
  ChevronDown,
  ChevronUp,
} from "lucide-react";
import { cn } from "@/app/lib/utils";

const RestaurantOverview = ({ address, openingTime, closingTime, cuisines, desc, priceRange }: { address: string; openingTime: string; closingTime: string; cuisines: string[]; desc: string; priceRange: string; }) => {
  const [showMore, setShowMore] = useState(false);
  const [isOverflowing, setIsOverflowing] = useState(false);
  const contentRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (contentRef.current) {
      setIsOverflowing(contentRef.current.scrollHeight > 100);
    }
  }, []);

  return (
    <div className="space-y-6 text-sm md:text-base">
      <div 
        // className="flex flex-col sm:flex-row sm:flex-wrap w-full gap-4"
        className="grid grid-cols-2 gap-2 sm:flex sm:flex-row sm:flex-wrap sm:gap-4 w-full"
      >
        <div className="bg-[#E8FFE1] p-3 rounded-xl border border-[#72E94E] flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
          <div>
            <svg
              className="w-6 h-6 sm:w-[34px] sm:h-[34px]"
              // width="34"
              // height="34"
              viewBox="0 0 34 34"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M16.9999 0.333008C26.2049 0.333008 33.6666 7.79467 33.6666 16.9997C33.6666 26.2047 26.2049 33.6663 16.9999 33.6663C7.79492 33.6663 0.333252 26.2047 0.333252 16.9997C0.333252 7.79467 7.79492 0.333008 16.9999 0.333008ZM16.9999 3.66634C13.4637 3.66634 10.0723 5.0711 7.57183 7.57158C5.07134 10.0721 3.66659 13.4635 3.66659 16.9997C3.66659 20.5359 5.07134 23.9273 7.57183 26.4278C10.0723 28.9282 13.4637 30.333 16.9999 30.333C20.5361 30.333 23.9275 28.9282 26.428 26.4278C28.9285 23.9273 30.3333 20.5359 30.3333 16.9997C30.3333 13.4635 28.9285 10.0721 26.428 7.57158C23.9275 5.0711 20.5361 3.66634 16.9999 3.66634ZM16.9999 6.99967C17.4081 6.99973 17.8021 7.1496 18.1072 7.42087C18.4123 7.69213 18.6072 8.06592 18.6549 8.47134L18.6666 8.66634V16.3097L23.1783 20.8213C23.4772 21.1213 23.6507 21.5237 23.6636 21.947C23.6766 22.3702 23.5279 22.7825 23.2478 23.1001C22.9678 23.4177 22.5773 23.6168 22.1558 23.657C21.7343 23.6972 21.3132 23.5754 20.9783 23.3163L20.8216 23.178L15.8216 18.178C15.5626 17.9188 15.3962 17.5813 15.3483 17.218L15.3333 16.9997V8.66634C15.3333 8.22431 15.5088 7.80039 15.8214 7.48783C16.134 7.17527 16.5579 6.99967 16.9999 6.99967Z"
                fill="#068D33"
              />
            </svg>
          </div>
          <div className="space-y-1">
            <p className="text-xs">Opening Hours</p>
            <p className="font-semibold text-sm">{openingTime} - {closingTime} Daily</p>
          </div>
        </div>
        <div className="bg-[#C8FAFF] p-3 rounded-xl border border-[#49EDFF] flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
          <div>
            <svg
              className="w-6 h-6 sm:w-[34px] sm:h-[34px]"
              // width="30"
              // height="34"
              viewBox="0 0 30 34"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M15 0.333008C18.9782 0.333008 22.7936 1.91336 25.6066 4.72641C28.4196 7.53945 30 11.3548 30 15.333C30 20.4563 27.2067 24.6497 24.2633 27.658C22.7925 29.1445 21.188 30.4924 19.47 31.6847L18.76 32.168L18.4267 32.3897L17.7983 32.7897L17.2383 33.1313L16.545 33.5347C16.0742 33.8027 15.5417 33.9436 15 33.9436C14.4583 33.9436 13.9258 33.8027 13.455 33.5347L12.7617 33.1313L11.895 32.598L11.575 32.3897L10.8917 31.9347C9.03829 30.6802 7.31178 29.2479 5.73667 27.658C2.79333 24.648 0 20.4563 0 15.333C0 11.3548 1.58035 7.53945 4.3934 4.72641C7.20644 1.91336 11.0218 0.333008 15 0.333008ZM15 3.66634C11.9058 3.66634 8.93834 4.8955 6.75042 7.08343C4.5625 9.27135 3.33333 12.2388 3.33333 15.333C3.33333 19.203 5.45333 22.5997 8.11833 25.3263C9.26437 26.4862 10.5029 27.5508 11.8217 28.5097L12.585 29.053C12.8317 29.2247 13.0683 29.3847 13.2967 29.533L13.9467 29.9497L14.5183 30.298L15 30.5797L15.7583 30.1313L16.37 29.748C16.695 29.5413 17.045 29.3097 17.415 29.053L18.1783 28.5097C19.4971 27.5508 20.7356 26.4862 21.8817 25.3263C24.5467 22.6013 26.6667 19.203 26.6667 15.333C26.6667 12.2388 25.4375 9.27135 23.2496 7.08343C21.0617 4.8955 18.0942 3.66634 15 3.66634ZM15 8.66634C16.7681 8.66634 18.4638 9.36872 19.714 10.619C20.9643 11.8692 21.6667 13.5649 21.6667 15.333C21.6667 17.1011 20.9643 18.7968 19.714 20.0471C18.4638 21.2973 16.7681 21.9997 15 21.9997C13.2319 21.9997 11.5362 21.2973 10.286 20.0471C9.03571 18.7968 8.33333 17.1011 8.33333 15.333C8.33333 13.5649 9.03571 11.8692 10.286 10.619C11.5362 9.36872 13.2319 8.66634 15 8.66634ZM15 11.9997C14.1159 11.9997 13.2681 12.3509 12.643 12.976C12.0179 13.6011 11.6667 14.449 11.6667 15.333C11.6667 16.2171 12.0179 17.0649 12.643 17.69C13.2681 18.3152 14.1159 18.6663 15 18.6663C15.8841 18.6663 16.7319 18.3152 17.357 17.69C17.9821 17.0649 18.3333 16.2171 18.3333 15.333C18.3333 14.449 17.9821 13.6011 17.357 12.976C16.7319 12.3509 15.8841 11.9997 15 11.9997Z"
                fill="#028C9B"
              />
            </svg>
          </div>
          <div className="space-y-1">
            <p className="text-xs">Location</p>
            <p className="font-semibold text-sm">{address}</p>
          </div>
        </div>
        <div className="bg-[#FFEFE1] p-3 rounded-xl border border-[#FFB778] flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
          <div>
            <svg
              className="w-6 h-6 sm:w-[34px] sm:h-[34px]"
              // width="30"
              // height="31"
              viewBox="0 0 30 31"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M10 2.16667C10 1.72464 10.1756 1.30072 10.4882 0.988155C10.8007 0.675595 11.2246 0.5 11.6667 0.5H18.3333C18.7754 0.5 19.1993 0.675595 19.5118 0.988155C19.8244 1.30072 20 1.72464 20 2.16667C20 2.60869 19.8244 3.03262 19.5118 3.34518C19.1993 3.65774 18.7754 3.83333 18.3333 3.83333H16.6667V5.55833C25.7333 6.375 31.6833 15.7783 28.215 24.4517C28.0913 24.7612 27.8777 25.0265 27.6017 25.2134C27.3257 25.4003 27 25.5001 26.6667 25.5H3.33333C3.0003 25.4998 2.67496 25.3998 2.39928 25.213C2.1236 25.0261 1.91022 24.7609 1.78667 24.4517C-1.68333 15.7783 4.26667 6.375 13.3333 5.55833V3.83333H11.6667C11.2246 3.83333 10.8007 3.65774 10.4882 3.34518C10.1756 3.03262 10 2.60869 10 2.16667ZM14.6167 8.83333C7.57333 8.83333 2.64333 15.5883 4.52167 22.1667H25.4783C27.3567 15.5883 22.4267 8.83333 15.3833 8.83333H14.6167ZM0 28.8333C0 28.3913 0.175595 27.9674 0.488155 27.6548C0.800716 27.3423 1.22464 27.1667 1.66667 27.1667H28.3333C28.7754 27.1667 29.1993 27.3423 29.5118 27.6548C29.8244 27.9674 30 28.3913 30 28.8333C30 29.2754 29.8244 29.6993 29.5118 30.0118C29.1993 30.3244 28.7754 30.5 28.3333 30.5H1.66667C1.22464 30.5 0.800716 30.3244 0.488155 30.0118C0.175595 29.6993 0 29.2754 0 28.8333Z"
                fill="#B76115"
              />
            </svg>
          </div>
          <div className="space-y-1">
            <p className="text-xs">Cuisine</p>
            <p className="font-semibold text-sm">
              {cuisines.join(", ")}
            </p>
          </div>
        </div>
        <div className="bg-[#EBE1FF] p-3 rounded-xl border border-[#C0A1FF] flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
          <div>
            <svg
              className="w-6 h-6 sm:w-[34px] sm:h-[34px]"
              // width="34"
              // height="34"
              viewBox="0 0 34 34"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M17.0002 0.333008C26.2052 0.333008 33.6668 7.79467 33.6668 16.9997C33.6668 26.2047 26.2052 33.6663 17.0002 33.6663C7.79516 33.6663 0.333496 26.2047 0.333496 16.9997C0.333496 7.79467 7.79516 0.333008 17.0002 0.333008ZM17.0002 3.66634C13.4639 3.66634 10.0726 5.0711 7.57207 7.57158C5.07159 10.0721 3.66683 13.4635 3.66683 16.9997C3.66683 20.5359 5.07159 23.9273 7.57207 26.4278C10.0726 28.9282 13.4639 30.333 17.0002 30.333C20.5364 30.333 23.9278 28.9282 26.4283 26.4278C28.9287 23.9273 30.3335 20.5359 30.3335 16.9997C30.3335 13.4635 28.9287 10.0721 26.4283 7.57158C23.9278 5.0711 20.5364 3.66634 17.0002 3.66634ZM13.6668 6.99967C13.9656 6.99959 14.259 7.07984 14.5161 7.23202C14.7733 7.3842 14.9848 7.60271 15.1285 7.86467L15.2135 8.04801L17.4635 13.6663H19.5002V8.66634C19.5006 8.24154 19.6633 7.83295 19.9549 7.52406C20.2465 7.21517 20.6451 7.02928 21.0692 7.00439C21.4932 6.97949 21.9108 7.11747 22.2365 7.39012C22.5623 7.66277 22.7717 8.04951 22.8218 8.47134L22.8335 8.66634V13.6663H23.6668C24.0916 13.6668 24.5002 13.8295 24.8091 14.1211C25.118 14.4127 25.3039 14.8113 25.3288 15.2353C25.3537 15.6594 25.2157 16.077 24.9431 16.4027C24.6704 16.7285 24.2837 16.9378 23.8618 16.988L23.6668 16.9997H22.8335V18.6663H23.6668C24.0916 18.6668 24.5002 18.8295 24.8091 19.1211C25.118 19.4127 25.3039 19.8113 25.3288 20.2353C25.3537 20.6594 25.2157 21.077 24.9431 21.4027C24.6704 21.7285 24.2837 21.9378 23.8618 21.988L23.6668 21.9997H22.8335V25.333C22.8334 25.7412 22.6836 26.1352 22.4123 26.4403C22.141 26.7454 21.7672 26.9402 21.3618 26.988L21.1668 26.9997H20.3335C20.0347 26.9998 19.7414 26.9195 19.4842 26.7673C19.2271 26.6152 19.0156 26.3966 18.8718 26.1347L18.7868 25.9513L17.2052 21.9997H14.5002V25.333C14.4997 25.7578 14.337 26.1664 14.0454 26.4753C13.7538 26.7842 13.3552 26.9701 12.9312 26.995C12.5071 27.0199 12.0895 26.8819 11.7638 26.6092C11.438 26.3366 11.2287 25.9498 11.1785 25.528L11.1668 25.333V21.9997H10.3335C9.9087 21.9992 9.50011 21.8365 9.19121 21.5449C8.88232 21.2533 8.69644 20.8548 8.67154 20.4307C8.64665 20.0066 8.78462 19.589 9.05727 19.2633C9.32992 18.9375 9.71667 18.7282 10.1385 18.678L10.3335 18.6663H11.1668V16.9997H10.3335C9.9087 16.9992 9.50011 16.8365 9.19121 16.5449C8.88232 16.2533 8.69644 15.8548 8.67154 15.4307C8.64665 15.0066 8.78462 14.589 9.05727 14.2633C9.32992 13.9375 9.71667 13.7282 10.1385 13.678L10.3335 13.6663H11.1668V8.66634C11.1669 8.25812 11.3168 7.86411 11.588 7.55905C11.8593 7.254 12.2331 7.0591 12.6385 7.01134L12.8335 6.99967H13.6668ZM15.2052 16.9997H14.5002V18.6663H15.8718L15.2052 16.9997ZM19.5002 16.9997H18.7952L19.4618 18.6663H19.5002V16.9997Z"
                fill="#6729E5"
              />
            </svg>
          </div>
          <div className="space-y-1">
            <p className="text-xs">Price Range</p>
            <p className="font-semibold text-sm">From {priceRange}</p>
          </div>
        </div>
      </div>
      <div>
        <h2 className="font-semibold mb-2 ml-3">About this Place</h2>
        <div
          ref={contentRef}
          className={cn(
            "transition-all overflow-hidden ml-3",
            showMore ? "max-h-[5000px]" : "max-h-[90px]"
          )}
        >
          <p className="text-gray-700 text-sm leading-relaxed">
            {desc.split("  ").map((part, idx) => (
              <span key={idx}>
                {part}
              </span>
            ))}
          </p>
        </div>
        {isOverflowing && (
          <button
            className="mt-2 flex items-center gap-1 text-sm text-[#0A6C6D] hover:underline cursor-pointer"
            onClick={() => setShowMore((prev) => !prev)}
          >
            {showMore ? "Show less" : "Show more"}
            {showMore ? <ChevronUp size={16} /> : <ChevronDown size={16} />}
          </button>
        )}
      </div>
    </div>
  );
};

export default RestaurantOverview;
